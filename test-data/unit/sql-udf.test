[case scalarUDF]
from pyspark.sql.functions import pandas_udf, PandasUDFType

@pandas_udf("str", PandasUDFType.SCALAR)
def f(x):
    return x

@pandas_udf("str", PandasUDFType.SCALAR)
def g(x, y):
    return x

@pandas_udf("str", PandasUDFType.SCALAR)
def h(*xs):
    return xs[0]

pandas_udf(lambda x: x, "str", PandasUDFType.SCALAR)
pandas_udf(lambda x, y: x, "str", PandasUDFType.SCALAR)
pandas_udf(lambda *xs: xs[0], "str", PandasUDFType.SCALAR)
[out]

[case groupedMapUdf]
from pyspark.sql.session import SparkSession
from pyspark.sql.functions import pandas_udf, PandasUDFType

@pandas_udf("id long", PandasUDFType.GROUPED_MAP)
def f(pdf):
   return pdf

spark = SparkSession.builder.getOrCreate()

dfg = spark.range(1).groupBy("id")
dfg.apply(f)

@pandas_udf("id long", PandasUDFType.GROUPED_MAP)
def g(key, pdf):
   return pdf

dfg.apply(g)
[out]

[case groupedAggUDF]
from pyspark.sql.functions import pandas_udf, PandasUDFType
from pyspark.sql.types import IntegerType

@pandas_udf(IntegerType(), PandasUDFType.GROUPED_AGG)
def f(x):
    return 42

@pandas_udf("int", PandasUDFType.GROUPED_AGG)
def g(x, y):
    return 42

@pandas_udf("int", PandasUDFType.GROUPED_AGG)
def h(*xs):
    return 42

pandas_udf(lambda x: 42, "str", PandasUDFType.GROUPED_AGG)
pandas_udf(lambda x, y: 42, "str", PandasUDFType.GROUPED_AGG)
pandas_udf(lambda *xs: 42, "str", PandasUDFType.GROUPED_AGG)
[out]

[case legacyUDF]
from pyspark.sql.functions import udf
from pyspark.sql.types import IntegerType

udf(lambda x: x, "string")

udf(lambda x: x)

@udf("string")
def f(x):
    return x

@udf(returnType="string")
def g(x):
    return x

@udf(returnType=IntegerType())
def h(x):
    return x

@udf
def i(x):
    return x

[out]
